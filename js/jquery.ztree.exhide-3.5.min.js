/*
 * JQuery zTree exHideNodes 3.5.01
 * http://zTree.me/
 *
 * Copyright (c) 2010 Hunter.z
 *
 * Licensed same as jquery - MIT License
 * http://www.opensource.org/licenses/mit-license.php
 *
 * email: hunter.z@263.net
 * Date: 2012-12-21
 */
(function(i){i.extend(!0,i.fn.zTree._z,{view:{clearOldFirstNode:function(c,b){for(var a=b.getNextNode();a;){if(a.isFirstNode){a.isFirstNode=!1;f.setNodeLineIcos(c,a);break}if(a.isLastNode)break;a=a.getNextNode()}},clearOldLastNode:function(c,b){for(var a=b.getPreNode();a;){if(a.isLastNode){a.isLastNode=!1;f.setNodeLineIcos(c,a);break}if(a.isFirstNode)break;a=a.getPreNode()}},makeDOMNodeMainBefore:function(c,b,a){c.push("<li ",a.isHidden?"style='display:none;' ":"","id='",a.tId,"' class='level",a.level,
"' tabindex='0' hidefocus='true' treenode>")},showNode:function(c,b){b.isHidden=!1;e.initShowForExCheck(c,b);i("#"+b.tId).show()},showNodes:function(c,b,a){if(b&&b.length!=0){var d={},h,j;for(h=0,j=b.length;h<j;h++){var g=b[h];if(!d[g.parentTId]){var i=g.getParentNode();d[g.parentTId]=i===null?e.getRoot(c):g.getParentNode()}f.showNode(c,g,a)}for(var k in d)b=d[k][c.data.key.children],f.setFirstNodeForShow(c,b),f.setLastNodeForShow(c,b)}},hideNode:function(c,b){b.isHidden=!0;b.isFirstNode=!1;b.isLastNode=
!1;e.initHideForExCheck(c,b);f.cancelPreSelectedNode(c,b);i("#"+b.tId).hide()},hideNodes:function(c,b,a){if(b&&b.length!=0){var d={},h,j;for(h=0,j=b.length;h<j;h++){var g=b[h];if((g.isFirstNode||g.isLastNode)&&!d[g.parentTId]){var i=g.getParentNode();d[g.parentTId]=i===null?e.getRoot(c):g.getParentNode()}f.hideNode(c,g,a)}for(var k in d)b=d[k][c.data.key.children],f.setFirstNodeForHide(c,b),f.setLastNodeForHide(c,b)}},setFirstNode:function(c,b){var a=c.data.key.children,d=b[a].length;d>0&&!b[a][0].isHidden?
b[a][0].isFirstNode=!0:d>0&&f.setFirstNodeForHide(c,b[a])},setLastNode:function(c,b){var a=c.data.key.children,d=b[a].length;d>0&&!b[a][0].isHidden?b[a][d-1].isLastNode=!0:d>0&&f.setLastNodeForHide(c,b[a])},setFirstNodeForHide:function(c,b){var a,d,h;for(d=0,h=b.length;d<h;d++){a=b[d];if(a.isFirstNode)break;if(!a.isHidden&&!a.isFirstNode){a.isFirstNode=!0;f.setNodeLineIcos(c,a);break}else a=null}return a},setFirstNodeForShow:function(c,b){var a,d,h,e,g;for(d=0,h=b.length;d<h;d++)if(a=b[d],!e&&!a.isHidden&&
a.isFirstNode){e=a;break}else if(!e&&!a.isHidden&&!a.isFirstNode)a.isFirstNode=!0,e=a,f.setNodeLineIcos(c,a);else if(e&&a.isFirstNode){a.isFirstNode=!1;g=a;f.setNodeLineIcos(c,a);break}return{"new":e,old:g}},setLastNodeForHide:function(c,b){var a,d;for(d=b.length-1;d>=0;d--){a=b[d];if(a.isLastNode)break;if(!a.isHidden&&!a.isLastNode){a.isLastNode=!0;f.setNodeLineIcos(c,a);break}else a=null}return a},setLastNodeForShow:function(c,b){var a,d,e,j;for(d=b.length-1;d>=0;d--)if(a=b[d],!e&&!a.isHidden&&
a.isLastNode){e=a;break}else if(!e&&!a.isHidden&&!a.isLastNode)a.isLastNode=!0,e=a,f.setNodeLineIcos(c,a);else if(e&&a.isLastNode){a.isLastNode=!1;j=a;f.setNodeLineIcos(c,a);break}return{"new":e,old:j}}},data:{initHideForExCheck:function(c,b){if(b.isHidden&&c.check&&c.check.enable)b._nocheck=!!b.nocheck,b.nocheck=!0,b.check_Child_State=-1,f.repairParentChkClassWithSelf&&f.repairParentChkClassWithSelf(c,b)},initShowForExCheck:function(c,b){if(!b.isHidden&&c.check&&c.check.enable){b.nocheck=b._nocheck;
delete b._nocheck;if(f.setChkClass){var a=i("#"+b.tId+s.id.CHECK);f.setChkClass(c,a,b)}f.repairParentChkClassWithSelf&&f.repairParentChkClassWithSelf(c,b)}}}});var k=i.fn.zTree,t=k._z.tools,s=k.consts,f=k._z.view,e=k._z.data;e.addInitNode(function(c,b,a){if(typeof a.isHidden=="string")a.isHidden=t.eqs(a.isHidden,"true");a.isHidden=!!a.isHidden;e.initHideForExCheck(c,a)});e.addBeforeA(function(){});e.addZTreeTools(function(c,b){b.showNodes=function(a,b){f.showNodes(c,a,b)};b.showNode=function(a,b){a&&
f.showNodes(c,[a],b)};b.hideNodes=function(a,b){f.hideNodes(c,a,b)};b.hideNode=function(a,b){a&&f.hideNodes(c,[a],b)};var a=b.checkNode;if(a)b.checkNode=function(c,e,f,g){(!c||!c.isHidden)&&a.apply(b,arguments)}});var l=e.initNode;e.tmpHideParent=-1;e.initNode=function(c,b,a,d,h,j,g){if(e.tmpHideParent!==d){e.tmpHideParent=d;var i=(d?d:e.getRoot(c))[c.data.key.children];e.tmpHideFirstNode=f.setFirstNodeForHide(c,i);e.tmpHideLastNode=f.setLastNodeForHide(c,i);f.setNodeLineIcos(c,e.tmpHideFirstNode);
f.setNodeLineIcos(c,e.tmpHideLastNode)}h=e.tmpHideFirstNode===a;j=e.tmpHideLastNode===a;l&&l.apply(e,arguments);j&&f.clearOldLastNode(c,a)};var m=e.makeChkFlag;if(m)e.makeChkFlag=function(c,b){(!b||!b.isHidden)&&m.apply(e,arguments)};var n=e.getTreeCheckedNodes;if(n)e.getTreeCheckedNodes=function(c,b,a,d){if(b&&b.length>0){var f=b[0].getParentNode();if(f&&f.isHidden)return[]}return n.apply(e,arguments)};var o=e.getTreeChangeCheckedNodes;if(o)e.getTreeChangeCheckedNodes=function(c,b,a){if(b&&b.length>
0){var d=b[0].getParentNode();if(d&&d.isHidden)return[]}return o.apply(e,arguments)};var p=f.expandCollapseSonNode;if(p)f.expandCollapseSonNode=function(c,b,a,d,e){(!b||!b.isHidden)&&p.apply(f,arguments)};var q=f.setSonNodeCheckBox;if(q)f.setSonNodeCheckBox=function(c,b,a,d){(!b||!b.isHidden)&&q.apply(f,arguments)};var r=f.repairParentChkClassWithSelf;if(r)f.repairParentChkClassWithSelf=function(c,b){(!b||!b.isHidden)&&r.apply(f,arguments)}})(jQuery);
